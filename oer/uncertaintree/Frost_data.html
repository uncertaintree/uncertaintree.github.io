<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Uncertaintree: Frost data</title>
  <meta name="description" content="Uncertaintree: Frost data" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Uncertaintree: Frost data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Uncertaintree: Frost data" />
  
  
  

<meta name="author" content="Holger Sennhenn-Reulen, Nordwestdeutsche Forstliche Versuchsanstalt (NW-FVA)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style_gitbook.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path=""><a href="#long-story-short"><i class="fa fa-check"></i><b>1</b> Long story short …</a></li>
<li class="chapter" data-level="2" data-path=""><a href="#organize-r-session"><i class="fa fa-check"></i><b>2</b> Organize R session</a></li>
<li class="chapter" data-level="3" data-path=""><a href="#data"><i class="fa fa-check"></i><b>3</b> Data</a><ul>
<li class="chapter" data-level="3.1" data-path=""><a href="#definition-of-frost-potential"><i class="fa fa-check"></i><b>3.1</b> Definition of frost potential</a></li>
<li class="chapter" data-level="3.2" data-path=""><a href="#definition-of-bud-burst-timing"><i class="fa fa-check"></i><b>3.2</b> Definition of bud burst timing</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path=""><a href="#some-descriptive-graphics"><i class="fa fa-check"></i><b>4</b> Some descriptive graphics</a></li>
<li class="chapter" data-level="5" data-path=""><a href="#another-important-data-management-step-towards-the-final-data-frame"><i class="fa fa-check"></i><b>5</b> Another important data-management step towards the final data-frame</a></li>
<li class="chapter" data-level="6" data-path=""><a href="#some-more-descriptive-graphics"><i class="fa fa-check"></i><b>6</b> Some more descriptive graphics</a></li>
<li class="chapter" data-level="7" data-path=""><a href="#final-data-frame-frost"><i class="fa fa-check"></i><b>7</b> Final data-frame ‘frost’</a></li>
<li class="chapter" data-level="" data-path=""><a href="#references"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><strong>Uncertaintree: Frost data</strong></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title"><strong>Uncertaintree: Frost data</strong></h1>
<p class="author"><em>Holger Sennhenn-Reulen<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, Nordwestdeutsche Forstliche Versuchsanstalt (NW-FVA)</em></p>
<p class="date" style="margin-top: 1.5em;"><em>March 4, 2022 (Version 0.1)</em></p>
</div>
<p>All contents are licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a>.</p>
<div id="long-story-short" class="section level1">
<h1><span class="header-section-number">1</span> Long story short …</h1>
<p>Copy-paste-use:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">frost &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">year =</span> <span class="dv">1947</span><span class="op">:</span><span class="dv">2021</span>, </a>
<a class="sourceLine" id="cb1-2" data-line-number="2">                    <span class="dt">frost =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1-3" data-line-number="3">                              <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                              <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1-5" data-line-number="5">                              <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1-6" data-line-number="6">                              <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a></code></pre></div>
</div>
<div id="organize-r-session" class="section level1">
<h1><span class="header-section-number">2</span> Organize R session</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">## Let&#39;s clean the current session:</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">## The packages we&#39;ll need:</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;rdwd&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;plyr&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">## If any of those two packages is not installed yet on your set-up, </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">## you can install - here for &#39;rdwd&#39; as example - by:</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">install.packages</span>(<span class="st">&quot;rdwd&quot;</span>)</a></code></pre></div>
</div>
<div id="data" class="section level1">
<h1><span class="header-section-number">3</span> Data</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">## For all the functions implemented in `rdwd`, the package web-site is worth </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">## a visit: </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">## https://bookdown.org/brry/rdwd/</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">## We use function `rdwd::nearbyStations` to search for weather stations in a </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">## circle with a radius of 10km around the city of Göttingen:</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">m &lt;-<span class="st"> </span><span class="kw">nearbyStations</span>(<span class="dt">lat =</span> <span class="fl">51.5328</span>, <span class="dt">lon =</span> <span class="fl">9.9351</span>, <span class="dt">radius =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">                    <span class="dt">res =</span> <span class="st">&quot;daily&quot;</span>, <span class="dt">var =</span> <span class="st">&quot;kl&quot;</span>,</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">                    <span class="dt">mindate =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2019-12-31&quot;</span>), </a>
<a class="sourceLine" id="cb5-10" data-line-number="10">                    <span class="dt">statname =</span> <span class="st">&quot;10k Around Goettingen&quot;</span>)</a></code></pre></div>
<pre><code>## Selecting stations...</code></pre>
<pre><code>## Preparing URLs...</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">## Object &#39;m&#39; is a data-frame:</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">class</span>(m)</a></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">## ... containing following variables:</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">names</span>(m)</a></code></pre></div>
<pre><code>##  [1] &quot;Stations_id&quot;   &quot;von_datum&quot;     &quot;bis_datum&quot;     &quot;Stationshoehe&quot;
##  [5] &quot;geoBreite&quot;     &quot;geoLaenge&quot;     &quot;Stationsname&quot;  &quot;Bundesland&quot;   
##  [9] &quot;res&quot;           &quot;var&quot;           &quot;per&quot;           &quot;hasfile&quot;      
## [13] &quot;dist&quot;          &quot;url&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">## We don&#39;t show the &#39;url&#39; column:</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">m[, <span class="dv">1</span><span class="op">:</span>(<span class="kw">ncol</span>(m) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)]</a></code></pre></div>
<pre><code>##        Stations_id  von_datum  bis_datum Stationshoehe geoBreite geoLaenge
## Target          NA       &lt;NA&gt;       &lt;NA&gt;            NA   51.5328    9.9351
## 26864         1691 1927-01-01 2021-04-07           167   51.5002    9.9507
## 26865         1691 1927-01-01 2021-04-07           167   51.5002    9.9507
##                 Stationsname    Bundesland   res  var        per hasfile
## Target 10k Around Goettingen          &lt;NA&gt;     z &lt;NA&gt;       &lt;NA&gt;      NA
## 26864             Goettingen Niedersachsen daily   kl historical    TRUE
## 26865             Goettingen Niedersachsen daily   kl     recent    TRUE
##            dist
## Target 0.000000
## 26864  3.782262
## 26865  3.782262</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co">## Load the historical as well as the recent data, reomve the lines in the </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">## recent data that are already contained in the historical data and combine </span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">## them into one data-frame object &#39;df&#39; using the &#39;rbind&#39; function:</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">readDWD</span>(<span class="dt">file =</span> <span class="kw">dataDWD</span>(m<span class="op">$</span>url[<span class="dv">2</span>], <span class="dt">read =</span> <span class="ot">FALSE</span>), <span class="dt">fread =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## rmarkdown::render -&gt; knitr::knit -&gt; call_block -&gt; block_exec -&gt; eng_r -&gt; in_dir -&gt; evaluate -&gt; readDWD -&gt; dataDWD -&gt; dirDWD: adding to directory &#39;/home/hsennhenn/Dropbox/01_oer/01_uncertaintree_materials/DWDdata&#39;</code></pre>
<pre><code>## rmarkdown::render -&gt; knitr::knit -&gt; call_block -&gt; block_exec -&gt; eng_r -&gt; in_dir -&gt; evaluate -&gt; readDWD -&gt; dataDWD: 1 file already existing and not downloaded again:  &#39;daily_kl_historical_tageswerte_KL_01691_19270101_20201231_hist.zip&#39;
## Now downloading 0 files...</code></pre>
<pre><code>## Reading 1 file with readDWD.data() and fread=FALSE ...</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">df_recent &lt;-<span class="st"> </span><span class="kw">readDWD</span>(<span class="dt">file =</span> <span class="kw">dataDWD</span>(m<span class="op">$</span>url[<span class="dv">3</span>], <span class="dt">read =</span> <span class="ot">FALSE</span>), <span class="dt">fread =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## rmarkdown::render -&gt; knitr::knit -&gt; call_block -&gt; block_exec -&gt; eng_r -&gt; in_dir -&gt; evaluate -&gt; readDWD -&gt; dataDWD -&gt; dirDWD: adding to directory &#39;/home/hsennhenn/Dropbox/01_oer/01_uncertaintree_materials/DWDdata&#39;</code></pre>
<pre><code>## rmarkdown::render -&gt; knitr::knit -&gt; call_block -&gt; block_exec -&gt; eng_r -&gt; in_dir -&gt; evaluate -&gt; readDWD -&gt; dataDWD: 1 file already existing and not downloaded again:  &#39;daily_kl_recent_tageswerte_KL_01691_akt.zip&#39;
## Now downloading 0 files...</code></pre>
<pre><code>## Reading 1 file with readDWD.data() and fread=FALSE ...</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">rm</span>(m) <span class="co"># dump m</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">max</span>(df<span class="op">$</span>MESS_DATUM)</a></code></pre></div>
<pre><code>## [1] &quot;2020-12-31 GMT&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">min</span>(df_recent<span class="op">$</span>MESS_DATUM)</a></code></pre></div>
<pre><code>## [1] &quot;2020-03-25 GMT&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">df_recent &lt;-<span class="st"> </span><span class="kw">subset</span>(df_recent, MESS_DATUM <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(df<span class="op">$</span>MESS_DATUM))</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw">max</span>(df_recent<span class="op">$</span>MESS_DATUM)</a></code></pre></div>
<pre><code>## [1] &quot;2021-09-25 GMT&quot;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">rbind</span>(df, df_recent)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">rm</span>(df_recent) <span class="co"># dump df_recent</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">## Generate date variables:</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5">df<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(df<span class="op">$</span>MESS_DATUM, <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">stop =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">df<span class="op">$</span>month &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(df<span class="op">$</span>MESS_DATUM, <span class="dt">start =</span> <span class="dv">6</span>, <span class="dt">stop =</span> <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb28-7" data-line-number="7">df<span class="op">$</span>day &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(df<span class="op">$</span>MESS_DATUM, <span class="dt">start =</span> <span class="dv">9</span>, <span class="dt">stop =</span> <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">df<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="dt">x =</span> <span class="kw">paste0</span>(df<span class="op">$</span>year, <span class="st">&quot;.&quot;</span>, df<span class="op">$</span>month, <span class="st">&quot;.&quot;</span>, df<span class="op">$</span>day), </a>
<a class="sourceLine" id="cb28-9" data-line-number="9">                   <span class="dt">format =</span> <span class="st">&quot;%Y.%m.%d&quot;</span>)</a>
<a class="sourceLine" id="cb28-10" data-line-number="10"></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="co">## Generate a &#39;winter&#39; ID such that all days from - for example - July 2004 </span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="co">## to June 2005 get the value 2004:</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13">df<span class="op">$</span>winter &lt;-<span class="st"> </span>df<span class="op">$</span>year</a>
<a class="sourceLine" id="cb28-14" data-line-number="14">df<span class="op">$</span>winter[<span class="kw">which</span>(df<span class="op">$</span>month <span class="op">&lt;</span><span class="st"> </span><span class="fl">6.5</span>)] &lt;-<span class="st"> </span>df<span class="op">$</span>year[<span class="kw">which</span>(df<span class="op">$</span>month <span class="op">&lt;</span><span class="st"> </span><span class="fl">6.5</span>)] <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="co">## Considering daily temperatures, we are in especially interested in the following three variables (Reference: [Link](https://s.gwdg.de/bAWmOv)):</span></a></code></pre></div>
<ul>
<li>TGK: TG <span class="math inline">\(=\)</span> Minimum der Temperatur in 5 cm über dem Erdboden</li>
<li>TNK: TN <span class="math inline">\(=\)</span> Minimum der Temperatur in 2 m über dem Erdboden</li>
<li>TMK: TM <span class="math inline">\(=\)</span> Mittel der Temperatur in 2 m über dem Erdboden</li>
</ul>
<p>So we need to check their availability in <code>df</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>year, <span class="dt">data =</span> df), <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb29-2" data-line-number="2">     <span class="dt">ylab =</span> <span class="st">&quot;Measurements per year&quot;</span>)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">dd &lt;-<span class="st"> </span><span class="kw">ddply</span>(df, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>), summarise,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">            <span class="dt">n_na_TGK =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(TGK)),</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">            <span class="dt">n_na_TNK =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(TNK)),</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">            <span class="dt">n_na_TMK =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(TMK)))</a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="kw">lines</span>(dd<span class="op">$</span>year, dd<span class="op">$</span>n_na_TGK, <span class="dt">col =</span> <span class="kw">rgb</span>(.<span class="dv">8</span>, <span class="fl">.2</span>, <span class="fl">.2</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="kw">lines</span>(dd<span class="op">$</span>year, dd<span class="op">$</span>n_na_TNK, <span class="dt">col =</span> <span class="kw">rgb</span>(.<span class="dv">8</span>, <span class="fl">.2</span>, <span class="fl">.2</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="kw">lines</span>(dd<span class="op">$</span>year, dd<span class="op">$</span>n_na_TMK, <span class="dt">col =</span> <span class="kw">rgb</span>(.<span class="dv">8</span>, <span class="fl">.2</span>, <span class="fl">.2</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-10" data-line-number="10"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(.<span class="dv">8</span>, <span class="fl">.2</span>, <span class="fl">.2</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;# NA&quot;</span>), <span class="dt">bg =</span> <span class="st">&quot;white&quot;</span>)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig01-1.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">rm</span>(dd)</a></code></pre></div>
<p>Data-quality and quantity seems to be stable starting with the year <span class="math inline">\(1947\)</span>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">summary</span>(<span class="kw">subset</span>(df, year <span class="op">==</span><span class="st"> </span><span class="dv">1946</span>)[, <span class="kw">c</span>(<span class="st">&quot;MESS_DATUM&quot;</span>, <span class="st">&quot;TGK&quot;</span>, <span class="st">&quot;TNK&quot;</span>, <span class="st">&quot;TMK&quot;</span>)])</a></code></pre></div>
<pre><code>##    MESS_DATUM              TGK           TNK               TMK         
##  Min.   :1946-01-01   Min.   : NA   Min.   :-17.300   Min.   :-12.700  
##  1st Qu.:1946-04-02   1st Qu.: NA   1st Qu.:  0.100   1st Qu.:  3.000  
##  Median :1946-07-02   Median : NA   Median :  4.800   Median :  9.800  
##  Mean   :1946-07-02   Mean   :NaN   Mean   :  4.234   Mean   :  8.666  
##  3rd Qu.:1946-10-01   3rd Qu.: NA   3rd Qu.:  9.300   3rd Qu.: 14.500  
##  Max.   :1946-12-31   Max.   : NA   Max.   : 17.500   Max.   : 25.100  
##                       NA&#39;s   :365</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">subset</span>(df, year <span class="op">&gt;</span><span class="st"> </span><span class="fl">1946.5</span>)</a></code></pre></div>
<p>There is one <code>NA</code> remaining in <code>TGK</code>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">df[<span class="kw">which</span>(<span class="kw">is.na</span>(df<span class="op">$</span>TGK)) <span class="op">+</span><span class="st"> </span><span class="dv">-2</span><span class="op">:</span><span class="dv">2</span>, ]</a></code></pre></div>
<pre><code>##       STATIONS_ID MESS_DATUM QN_3   FX  FM QN_4 RSK RSKF  SDK SHK_TAG  NM  VPM
## 22978        1691 1994-06-29    3 13.0 2.4   10 5.3    6  6.3       0 6.0 21.1
## 22979        1691 1994-06-30    3  8.8 2.4   10 0.0    0 13.5       0 2.7 12.3
## 22980        1691 1994-07-01    3  7.0 2.1   10 0.0    0 12.6       0 3.3 13.2
## 22981        1691 1994-07-02    3  7.8 3.0   10 0.0    0 12.7       0 2.0 16.2
## 22982        1691 1994-07-03    3  5.5 1.5   10 0.0    0 13.3       0 3.3 18.2
##           PM  TMK UPM  TXK  TNK  TGK eor year month day       date winter
## 22978  998.0 21.6  80 29.6 17.8 17.0 eor 1994     6  29 1994-06-29   1993
## 22979 1004.7 16.3  65 22.0 11.5 10.1 eor 1994     6  30 1994-06-30   1993
## 22980 1001.1 17.1  68 24.2  8.6   NA eor 1994     7   1 1994-07-01   1994
## 22981  997.0 20.8  65 27.3 10.1  9.3 eor 1994     7   2 1994-07-02   1994
## 22982  995.5 23.8  63 32.5 13.6 12.7 eor 1994     7   3 1994-07-03   1994</code></pre>
<p>This was a day in full summer with no sign of frost at all in this period.
Since we are only interested in quantification of the frost potential, it seems completely safe to do the following:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">df<span class="op">$</span>TGK[<span class="kw">which</span>(<span class="kw">is.na</span>(df<span class="op">$</span>TGK))] &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co">## Safe!</span></a></code></pre></div>
<p>Auxiliary variable <code>lines</code>:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">df<span class="op">$</span>line &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(df)</a></code></pre></div>
<div id="definition-of-frost-potential" class="section level2">
<h2><span class="header-section-number">3.1</span> Definition of frost potential</h2>
<p>A first note:
It is generally not recommended–or even more some form of bad scientific practice–to ‘cut’ continuosly scaled variables.
But here in this <strong>frost</strong> scenario, it seems justified to think of roles of water in plant cells differently for below or above the <span class="math inline">\(0\)</span> degree celsius <em>threshold</em> <span class="citation">(Sakai and Larcher <a href="#ref-Sakai:1987">1987</a>)</span>.</p>
<p>For sensitiviy checking of such a discrete cut value, <span class="citation">Hänninen (<a href="#ref-Haenninen:1996">1996</a>)</span> use several temperature values – <span class="math inline">\(-10\)</span> degree Celsius to <span class="math inline">\(-5\)</span> degree Celsius at <span class="math inline">\(2\)</span>m above ground – for the threshold defining <strong>lethal</strong> frost.</p>
<p><span class="citation">Sagar and Waterhouse (<a href="#ref-Sagar:Waterhouse:2018">2018</a>)</span> define severe frost in the context of Douglas-fir regeneration as minimum day temperature below <span class="math inline">\(-4\)</span> degree Celsius.
For this definition, they measured temperatures at several plant heights along a vertical profile.</p>
<p><span class="citation">Hannerz (<a href="#ref-Hannerz:1994">1994</a>)</span> (p. 248) write:
‘Christersson and von Fircks (1988) showed that new shoots on Norway spruce seedlings were injured when the temperatures around the needles sank below <span class="math inline">\(-2\)</span> degree C[elsius].’</p>
<p>In our data, we have temperatures at <span class="math inline">\(5\)</span>cm and at <span class="math inline">\(200\)</span>cm above ground.
Out of convenience, we choose <span class="math inline">\(50\)</span>cm as a vertical distance above ground in which we can expect to have a relevant part of a plant’s needles. <!--- on a douglas fir regenarion culture.-->
We further stick to the ‘below <span class="math inline">\(-2\)</span> degree Celsius’ definition for frost that should have some considerable impact–i.e. lead to damages–on the plant’s needles.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">df<span class="op">$</span>T_min_50cm &lt;-<span class="st"> </span>df<span class="op">$</span>TGK <span class="op">+</span><span class="st"> </span>(.<span class="dv">45</span><span class="op">/</span><span class="fl">1.95</span>) <span class="op">*</span><span class="st"> </span>(df<span class="op">$</span>TNK <span class="op">-</span><span class="st"> </span>df<span class="op">$</span>TGK)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="co">## &#39;Severe frost&#39;</span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3">df<span class="op">$</span>frost &lt;-<span class="st"> </span>df<span class="op">$</span>T_min_50cm <span class="op">&lt;</span><span class="st"> </span><span class="fl">-1.95</span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="kw">summary</span>(df<span class="op">$</span>frost)</a></code></pre></div>
<pre><code>##    Mode   FALSE    TRUE 
## logical   22118    5179</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">dd &lt;-<span class="st"> </span><span class="kw">ddply</span>(df, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>), summarise, <span class="dt">mean_frost =</span> <span class="kw">mean</span>(frost))</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">plot</span>(dd)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig02-1.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">tmp &lt;-<span class="st"> </span><span class="kw">subset</span>(df, winter <span class="op">&gt;</span><span class="st"> </span><span class="fl">1946.5</span> <span class="op">&amp;</span><span class="st"> </span>winter <span class="op">&lt;</span><span class="st"> </span><span class="fl">2019.5</span>)</a>
<a class="sourceLine" id="cb41-2" data-line-number="2">dd &lt;-<span class="st"> </span><span class="kw">ddply</span>(tmp, <span class="kw">c</span>(<span class="st">&quot;winter&quot;</span>), summarise, <span class="dt">mean_frost =</span> <span class="kw">mean</span>(frost))</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="kw">plot</span>(dd, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig03-1.png" width="672" /></p>
<!---(Hannes K REHAN und Gottfried S TEYRER): 
Trotz mildem Winter Frostschäden an Bäumen:
Im Jahr 2007 besonders früher Austrieb?
Kann man das auch in der hier verwendeten Definition über die Temperatursumme sehen?

Weiterhin: IM LWF Merkblatt 31 wurde eine besonders ausgeprägte Spätfrostschadennacht am 4. Mai 2011 beobachtet. 
Kann ich auch diese sehen?

```r
## Frost in May:
## https://www.medienservice.sachsen.de/medien/news/238026
dd <- ddply(df, c("year", "month"), summarise, mean_frost = mean(frost))
sdd <- subset(dd, month == 5)
plot(sdd$year, sdd$mean_frost, xlab = "Year", ylab = "Proportion of days with frost in May", 
     bty = "n")
abline(v = 2020)
```

<img src="Frost_data_files/figure-html/fig04-1.png" width="672" />

```r
# subset(df, year == 2020 & month == 5)
```
-->
</div>
<div id="definition-of-bud-burst-timing" class="section level2">
<h2><span class="header-section-number">3.2</span> Definition of bud burst timing</h2>
<p>‘One of the most common problems seen in plantations of Douglas fir seedlings is damage caused by late spring frost,
known to be highly correlated with the timing of bud burst.’ <span class="citation">(Malmqvist et al. <a href="#ref-Malmqvist:EtAl:2017">2017</a>)</span></p>
<p>‘When the number of accumulated degree days (daily mean temperature[5 °C) reaches a certain threshold, specific for different species of conifers, buds start growing (Grossnickle 2000).’ <span class="citation">(Malmqvist et al. <a href="#ref-Malmqvist:EtAl:2017">2017</a>)</span></p>
<p>Based on <span class="citation">Thomson and Moncrieff (<a href="#ref-Thomson:Moncrieff:1982">1982</a>)</span>, we could use the following algorithm to estimate yearly bud burst timing for Göttingen:
- Start accumulating on March, 20.
- If <span class="math inline">\(\vert \text{TMK} - 4.44\vert &gt; 0\)</span>, then:
<span class="math display">\[
z_{\text{new}} = z_{\text{old}} + TMK - 4.44
\]</span>
- Bud burst: first day for which <span class="math inline">\(z \geq 220\)</span>.</p>
<p>However, this algorithm was based on data from plot in Haney, West Canada.
Is this transferable to Göttingen?
We have <code>TMK</code> (TM <span class="math inline">\(=\)</span> Mittel der Temperatur in 2 m über dem Erdboden) variable included in our data (<a href="https://s.gwdg.de/y2saWE">Link</a>).
Based on <code>TMK</code>, we can calculate monthly averages for period between 1980 and 2010 and compare these to Haney (B.C.), Canada:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co">## Climate comparison Haney, B.C., vs. Goettingen:</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">clim &lt;-<span class="st"> </span><span class="kw">subset</span>(df, (year <span class="op">&gt;</span><span class="st"> </span><span class="fl">1979.5</span>) <span class="op">&amp;</span><span class="st"> </span>(year <span class="op">&lt;</span><span class="st"> </span><span class="fl">2010.5</span>))</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">dd &lt;-<span class="st"> </span><span class="kw">ddply</span>(clim, <span class="kw">c</span>(<span class="st">&quot;month&quot;</span>), summarise, <span class="dt">mean_temp =</span> <span class="kw">mean</span>(TMK))</a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="co">## https://en.wikipedia.org/wiki/Haney,_British_Columbia</span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5">temp_haney &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">4.4</span>, <span class="fl">6.6</span>, <span class="fl">9.3</span>, <span class="fl">12.4</span>, <span class="fl">15.1</span>, <span class="fl">17.5</span>, <span class="fl">17.7</span>, <span class="fl">14.8</span>, <span class="fl">10.1</span>, <span class="fl">5.4</span>, <span class="fl">2.6</span>)</a>
<a class="sourceLine" id="cb42-6" data-line-number="6">prec_haney &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">227</span>, <span class="dv">178</span>, <span class="dv">158</span>, <span class="dv">133</span>, <span class="dv">111</span>, <span class="dv">91</span>, <span class="dv">66</span>, <span class="dv">60</span>, <span class="dv">86</span>, <span class="dv">161</span>, <span class="dv">266</span>, <span class="dv">250</span>)<span class="op">/</span><span class="fl">2.54</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7"><span class="co">## https://bookdown.org/brry/rdwd/use-case-long-term-climate-graph.html</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8">temp_goe &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">1.1</span>, <span class="fl">4.1</span>, <span class="fl">8.2</span>, <span class="fl">12.7</span>, <span class="fl">15.8</span>, <span class="fl">17.4</span>, <span class="fl">16.8</span>, <span class="fl">13.5</span>, <span class="dv">9</span>, <span class="fl">4.5</span>, <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb42-9" data-line-number="9">prec_goe &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">44</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">54</span>, <span class="dv">65</span>, <span class="dv">73</span>, <span class="dv">64</span>, <span class="dv">47</span>, <span class="dv">47</span>, <span class="dv">46</span>, <span class="dv">49</span>)</a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, temp_haney, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>))</a>
<a class="sourceLine" id="cb42-11" data-line-number="11"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, temp_goe)</a>
<a class="sourceLine" id="cb42-12" data-line-number="12"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, dd<span class="op">$</span>mean_temp)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig05-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co">## ... a rather cautios conclusion:</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="co">## with respect to the aims of this &quot;study&quot;, we are able to apply</span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="co">## a) start cumulating degree days from march 20, and</span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="co">## b) take 220 as threshold</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="co">## to the data from Goettingen climate station. </span></a></code></pre></div>
<p>This looks rather comparable (?), so let’s apply the algorithm of <span class="citation">Thomson and Moncrieff (<a href="#ref-Thomson:Moncrieff:1982">1982</a>)</span>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">df<span class="op">$</span>z &lt;-<span class="st"> </span>df<span class="op">$</span>TMK <span class="op">-</span><span class="st"> </span><span class="fl">4.44</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2">df<span class="op">$</span>z &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(df<span class="op">$</span>z <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>df<span class="op">$</span>z</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">df<span class="op">$</span>z[df<span class="op">$</span>month <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.5</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="co"># df$z[df$month == 3 &amp; df$day &lt; 19.5] &lt;- 0</span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5">df<span class="op">$</span>z[df<span class="op">$</span>month <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>day <span class="op">&lt;</span><span class="st"> </span><span class="fl">29.5</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb44-6" data-line-number="6"><span class="cf">for</span> (y <span class="cf">in</span> <span class="kw">sort</span>(<span class="kw">unique</span>(df<span class="op">$</span>year))) {</a>
<a class="sourceLine" id="cb44-7" data-line-number="7">  sdf &lt;-<span class="st"> </span><span class="kw">subset</span>(df, year <span class="op">==</span><span class="st"> </span>y)</a>
<a class="sourceLine" id="cb44-8" data-line-number="8">  df<span class="op">$</span>z[sdf<span class="op">$</span>line] &lt;-<span class="st"> </span><span class="kw">cumsum</span>(sdf<span class="op">$</span>z)</a>
<a class="sourceLine" id="cb44-9" data-line-number="9">}</a></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">dd &lt;-<span class="st"> </span><span class="kw">ddply</span>(df, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>), summarise,</a>
<a class="sourceLine" id="cb45-2" data-line-number="2">            <span class="dt">date220 =</span> date[<span class="kw">which</span>((z <span class="op">-</span><span class="st"> </span><span class="dv">220</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">            <span class="dt">date320 =</span> date[<span class="kw">which</span>((z <span class="op">-</span><span class="st"> </span><span class="dv">320</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb45-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">merge</span>(df, dd, <span class="dt">by =</span> <span class="st">&quot;year&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="some-descriptive-graphics" class="section level1">
<h1><span class="header-section-number">4</span> Some descriptive graphics</h1>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">res &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">year =</span> <span class="kw">sort</span>(<span class="kw">unique</span>(df<span class="op">$</span>year)), </a>
<a class="sourceLine" id="cb46-2" data-line-number="2">                  <span class="dt">n_days_year =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">                  <span class="dt">n_days_frost =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">                  <span class="dt">n_days_at_risk =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">                  <span class="dt">n_days_frost_and_at_risk =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb46-6" data-line-number="6">                  <span class="dt">n_days_frost_and_not_at_risk =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb46-7" data-line-number="7">                  <span class="dt">n_days_no_frost_and_at_risk =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb46-8" data-line-number="8">                  <span class="dt">n_days_no_frost_and_not_at_risk =</span> <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb46-9" data-line-number="9"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.5</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.2</span>, <span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="fl">.4</span>, <span class="dv">0</span>), <span class="dt">tcl =</span> <span class="fl">-.3</span>, <span class="dt">oma =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb46-10" data-line-number="10"><span class="kw">plot</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">365</span>, <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.6</span>, <span class="dt">length.out =</span> <span class="dv">366</span>), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb46-11" data-line-number="11">     <span class="dt">ylab =</span> <span class="st">&quot;Degree days [/1000] since March, 20&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb46-12" data-line-number="12"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;1970-&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="st">&quot;-01&quot;</span>), <span class="st">&quot;1971-01-01&quot;</span>))), </a>
<a class="sourceLine" id="cb46-13" data-line-number="13">     <span class="dt">labels =</span> <span class="kw">months</span>(<span class="kw">as.Date</span>(<span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;1970-&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="st">&quot;-01&quot;</span>), <span class="st">&quot;1971-01-01&quot;</span>))), <span class="dt">las =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb46-14" data-line-number="14"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;1970-&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="st">&quot;-01&quot;</span>), <span class="st">&quot;1971-01-01&quot;</span>))), <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb46-15" data-line-number="15"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">.5</span>), <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb46-16" data-line-number="16">paint &lt;-<span class="st"> </span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(res), <span class="dt">alpha =</span> <span class="fl">.8</span>)</a>
<a class="sourceLine" id="cb46-17" data-line-number="17">paint_a &lt;-<span class="st"> </span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(res), <span class="dt">alpha =</span> <span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb46-18" data-line-number="18"><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(res)) {</a>
<a class="sourceLine" id="cb46-19" data-line-number="19">  year_index &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(df<span class="op">$</span>year))[index]</a>
<a class="sourceLine" id="cb46-20" data-line-number="20">  sdf &lt;-<span class="st"> </span><span class="kw">subset</span>(df, year <span class="op">==</span><span class="st"> </span>year_index)</a>
<a class="sourceLine" id="cb46-21" data-line-number="21">  </a>
<a class="sourceLine" id="cb46-22" data-line-number="22">  date_frost &lt;-<span class="st"> </span>sdf<span class="op">$</span>date[<span class="kw">which</span>(sdf<span class="op">$</span>frost)]</a>
<a class="sourceLine" id="cb46-23" data-line-number="23">  index_a &lt;-<span class="st"> </span><span class="kw">which</span>(sdf<span class="op">$</span>z <span class="op">&gt;</span><span class="st"> </span><span class="dv">220</span>)</a>
<a class="sourceLine" id="cb46-24" data-line-number="24">  index_b &lt;-<span class="st"> </span><span class="kw">which</span>(sdf<span class="op">$</span>z <span class="op">&lt;</span><span class="st"> </span><span class="dv">320</span>)</a>
<a class="sourceLine" id="cb46-25" data-line-number="25">  date_a &lt;-<span class="st"> </span>sdf<span class="op">$</span>date[index_a[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb46-26" data-line-number="26">  date_b &lt;-<span class="st"> </span>sdf<span class="op">$</span>date[index_b[<span class="kw">length</span>(index_b)]]</a>
<a class="sourceLine" id="cb46-27" data-line-number="27">  <span class="kw">rm</span>(index_a, index_b)</a>
<a class="sourceLine" id="cb46-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb46-29" data-line-number="29">  res<span class="op">$</span>n_days_year[index] &lt;-<span class="st"> </span><span class="kw">nrow</span>(sdf)</a>
<a class="sourceLine" id="cb46-30" data-line-number="30">  res<span class="op">$</span>n_days_frost[index] &lt;-<span class="st"> </span><span class="kw">length</span>(date_frost)</a>
<a class="sourceLine" id="cb46-31" data-line-number="31">  res<span class="op">$</span>n_days_at_risk[index] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(date_b <span class="op">-</span><span class="st"> </span>date_a)</a>
<a class="sourceLine" id="cb46-32" data-line-number="32">  res<span class="op">$</span>n_days_frost_and_at_risk[index] &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">which</span>((date_frost <span class="op">&gt;=</span><span class="st"> </span>date_a) <span class="op">&amp;</span><span class="st"> </span>(date_frost <span class="op">&lt;=</span><span class="st"> </span>date_b)))</a>
<a class="sourceLine" id="cb46-33" data-line-number="33">  res<span class="op">$</span>n_days_frost_and_not_at_risk[index] &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">which</span>((date_frost <span class="op">&lt;</span><span class="st"> </span>date_a) <span class="op">|</span><span class="st"> </span>(date_frost <span class="op">&gt;</span><span class="st"> </span>date_b)))</a>
<a class="sourceLine" id="cb46-34" data-line-number="34">  res<span class="op">$</span>n_days_no_frost_and_at_risk[index] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(date_b <span class="op">-</span><span class="st"> </span>date_a) <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">which</span>((date_frost <span class="op">&gt;=</span><span class="st"> </span>date_a) <span class="op">&amp;</span><span class="st"> </span>(date_frost <span class="op">&lt;=</span><span class="st"> </span>date_b)))</a>
<a class="sourceLine" id="cb46-35" data-line-number="35">  res<span class="op">$</span>n_days_no_frost_and_not_at_risk[index] &lt;-<span class="st"> </span><span class="kw">nrow</span>(sdf) <span class="op">-</span><span class="st"> </span><span class="kw">as.numeric</span>(date_b <span class="op">-</span><span class="st"> </span>date_a) <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">which</span>((date_frost <span class="op">&lt;</span><span class="st"> </span>date_a) <span class="op">|</span><span class="st"> </span>(date_frost <span class="op">&gt;</span><span class="st"> </span>date_b)))</a>
<a class="sourceLine" id="cb46-36" data-line-number="36">  </a>
<a class="sourceLine" id="cb46-37" data-line-number="37">  <span class="co"># plot:</span></a>
<a class="sourceLine" id="cb46-38" data-line-number="38">  tmp &lt;-<span class="st"> </span><span class="kw">julian</span>(sdf<span class="op">$</span>date[sdf<span class="op">$</span>z <span class="op">&lt;</span><span class="st"> </span><span class="dv">220</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">paste0</span>(year_index, <span class="st">&quot;-01-01&quot;</span>)))</a>
<a class="sourceLine" id="cb46-39" data-line-number="39">  <span class="kw">lines</span>(tmp, sdf<span class="op">$</span>z[sdf<span class="op">$</span>z <span class="op">&lt;</span><span class="st"> </span><span class="dv">220</span>]<span class="op">/</span><span class="dv">1000</span>, <span class="dt">lend =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> paint_a[index])</a>
<a class="sourceLine" id="cb46-40" data-line-number="40">  tmp &lt;-<span class="st"> </span><span class="kw">julian</span>(sdf<span class="op">$</span>date[sdf<span class="op">$</span>z <span class="op">&gt;</span><span class="st"> </span><span class="dv">320</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">paste0</span>(year_index, <span class="st">&quot;-01-01&quot;</span>)))</a>
<a class="sourceLine" id="cb46-41" data-line-number="41">  <span class="kw">lines</span>(tmp, sdf<span class="op">$</span>z[sdf<span class="op">$</span>z <span class="op">&gt;</span><span class="st"> </span><span class="dv">320</span>]<span class="op">/</span><span class="dv">1000</span>, <span class="dt">lend =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> paint_a[index])</a>
<a class="sourceLine" id="cb46-42" data-line-number="42">  tmp &lt;-<span class="st"> </span><span class="kw">julian</span>(sdf<span class="op">$</span>date[(sdf<span class="op">$</span>z <span class="op">&gt;=</span><span class="st"> </span><span class="dv">220</span>) <span class="op">&amp;</span><span class="st"> </span>(sdf<span class="op">$</span>z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">320</span>)]) <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">paste0</span>(year_index, <span class="st">&quot;-01-01&quot;</span>)))</a>
<a class="sourceLine" id="cb46-43" data-line-number="43">  <span class="co">#lines(tmp, sdf$z[(sdf$z &gt;= 220) &amp; (sdf$z &lt;= 320)]/1000, </span></a>
<a class="sourceLine" id="cb46-44" data-line-number="44">  <span class="co">#      col = 2, lend = 1, lwd = 2)</span></a>
<a class="sourceLine" id="cb46-45" data-line-number="45">  tmp &lt;-<span class="st"> </span><span class="kw">julian</span>(date_frost[<span class="kw">which</span>((date_frost <span class="op">&gt;=</span><span class="st"> </span>date_a) <span class="op">&amp;</span><span class="st"> </span>(date_frost <span class="op">&lt;=</span><span class="st"> </span>date_b))])</a>
<a class="sourceLine" id="cb46-46" data-line-number="46">  tmp_a &lt;-<span class="st"> </span>tmp <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">paste0</span>(year_index, <span class="st">&quot;-01-01&quot;</span>)))</a>
<a class="sourceLine" id="cb46-47" data-line-number="47">  tmp_b &lt;-<span class="st"> </span>tmp <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">paste0</span>(year_index <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;-12-31&quot;</span>)))</a>
<a class="sourceLine" id="cb46-48" data-line-number="48">  <span class="co"># rug(tmp, col = 2)</span></a>
<a class="sourceLine" id="cb46-49" data-line-number="49">  <span class="kw">points</span>(tmp_a, sdf<span class="op">$</span>z[tmp_b]<span class="op">/</span><span class="dv">1000</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">.7</span>, <span class="dt">col =</span> paint[index])</a>
<a class="sourceLine" id="cb46-50" data-line-number="50">  tmp &lt;-<span class="st"> </span><span class="kw">julian</span>(date_frost[<span class="kw">which</span>((date_frost <span class="op">&lt;</span><span class="st"> </span>date_a) <span class="op">|</span><span class="st"> </span>(date_frost <span class="op">&gt;</span><span class="st"> </span>date_b))])</a>
<a class="sourceLine" id="cb46-51" data-line-number="51">  tmp_a &lt;-<span class="st"> </span>tmp <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">paste0</span>(year_index, <span class="st">&quot;-01-01&quot;</span>)))</a>
<a class="sourceLine" id="cb46-52" data-line-number="52">  tmp_b &lt;-<span class="st"> </span>tmp <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(<span class="kw">as.Date</span>(<span class="kw">paste0</span>(year_index <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;-12-31&quot;</span>)))</a>
<a class="sourceLine" id="cb46-53" data-line-number="53">  <span class="co"># rug(tmp, col = 4)</span></a>
<a class="sourceLine" id="cb46-54" data-line-number="54">  <span class="kw">points</span>(tmp_a, sdf<span class="op">$</span>z[tmp_b]<span class="op">/</span><span class="dv">1000</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> paint_a[index])</a>
<a class="sourceLine" id="cb46-55" data-line-number="55">}</a>
<a class="sourceLine" id="cb46-56" data-line-number="56">le &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sort</span>(<span class="kw">unique</span>(df<span class="op">$</span>year))[<span class="dv">1</span>], <span class="st">&quot;&quot;</span>, <span class="st">&quot;...&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">sort</span>(<span class="kw">unique</span>(df<span class="op">$</span>year))[<span class="dv">25</span>], <span class="st">&quot;&quot;</span>, <span class="st">&quot;...&quot;</span>, <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb46-57" data-line-number="57">        <span class="kw">sort</span>(<span class="kw">unique</span>(df<span class="op">$</span>year))[<span class="dv">50</span>], <span class="st">&quot;&quot;</span>, <span class="st">&quot;...&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">sort</span>(<span class="kw">unique</span>(df<span class="op">$</span>year))[<span class="kw">length</span>(paint)])</a>
<a class="sourceLine" id="cb46-58" data-line-number="58">pa &lt;-<span class="st"> </span><span class="kw">c</span>(paint[<span class="dv">1</span>], <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, paint[<span class="dv">25</span>], <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, paint[<span class="dv">50</span>], <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, paint[<span class="kw">length</span>(paint)])</a>
<a class="sourceLine" id="cb46-59" data-line-number="59"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">legend =</span> le, <span class="dt">col =</span> pa)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig06-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">rm</span>(le, pa)</a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">hist</span>(<span class="kw">as.numeric</span>(dd<span class="op">$</span>date320 <span class="op">-</span><span class="st"> </span>dd<span class="op">$</span>date220), <span class="dt">xlab =</span> <span class="st">&quot;Duration of 1st dev. stage [Days]&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig07-1.png" width="672" /></p>
</div>
<div id="another-important-data-management-step-towards-the-final-data-frame" class="section level1">
<h1><span class="header-section-number">5</span> Another important data-management step towards the final data-frame</h1>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">sdf &lt;-<span class="st"> </span><span class="kw">subset</span>(df, z <span class="op">&gt;=</span><span class="st"> </span><span class="dv">220</span>)</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">sdf &lt;-<span class="st"> </span><span class="kw">subset</span>(sdf, z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">320</span>)</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">dd &lt;-<span class="st"> </span><span class="kw">ddply</span>(sdf, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>), summarise,</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">            <span class="dt">n_frost =</span> <span class="kw">sum</span>(frost), </a>
<a class="sourceLine" id="cb49-5" data-line-number="5">            <span class="dt">bud_burst =</span> date220[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb49-6" data-line-number="6">            <span class="dt">end_1st_dev_stage =</span> date320[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb49-7" data-line-number="7">dd &lt;-<span class="st"> </span><span class="kw">subset</span>(dd, <span class="op">!</span><span class="kw">is.na</span>(n_frost))</a>
<a class="sourceLine" id="cb49-8" data-line-number="8">dd<span class="op">$</span>may1st &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">paste0</span>(dd<span class="op">$</span>year, <span class="st">&quot;-05-01&quot;</span>))</a>
<a class="sourceLine" id="cb49-9" data-line-number="9">dd<span class="op">$</span>begin_julian &lt;-<span class="st"> </span><span class="kw">julian</span>(dd<span class="op">$</span>bud_burst, <span class="dt">origin =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1900-01-01&quot;</span>)) <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(dd<span class="op">$</span>may1st, <span class="dt">origin =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1900-01-01&quot;</span>))</a>
<a class="sourceLine" id="cb49-10" data-line-number="10">dd<span class="op">$</span>end_julian &lt;-<span class="st"> </span><span class="kw">julian</span>(dd<span class="op">$</span>end_1st_dev_stage, <span class="dt">origin =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1900-01-01&quot;</span>)) <span class="op">-</span><span class="st"> </span><span class="kw">julian</span>(dd<span class="op">$</span>may1st, <span class="dt">origin =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1900-01-01&quot;</span>))</a>
<a class="sourceLine" id="cb49-11" data-line-number="11"><span class="kw">summary</span>(dd)</a></code></pre></div>
<pre><code>##       year         n_frost       bud_burst          end_1st_dev_stage   
##  Min.   :1947   Min.   :0.00   Min.   :1947-05-09   Min.   :1947-05-17  
##  1st Qu.:1966   1st Qu.:0.00   1st Qu.:1965-11-11   1st Qu.:1965-11-23  
##  Median :1984   Median :0.00   Median :1984-05-19   Median :1984-06-02  
##  Mean   :1984   Mean   :0.32   Mean   :1984-05-12   Mean   :1984-05-24  
##  3rd Qu.:2002   3rd Qu.:0.00   3rd Qu.:2002-11-09   3rd Qu.:2002-11-20  
##  Max.   :2021   Max.   :5.00   Max.   :2021-05-22   Max.   :2021-06-03  
##      may1st            begin_julian     end_julian   
##  Min.   :1947-05-01   Min.   :-4.00   Min.   : 8.00  
##  1st Qu.:1965-10-30   1st Qu.: 8.00   1st Qu.:20.00  
##  Median :1984-05-01   Median :11.00   Median :24.00  
##  Mean   :1984-04-30   Mean   :11.69   Mean   :23.47  
##  3rd Qu.:2002-10-30   3rd Qu.:16.00   3rd Qu.:28.50  
##  Max.   :2021-05-01   Max.   :23.00   Max.   :36.00</code></pre>
</div>
<div id="some-more-descriptive-graphics" class="section level1">
<h1><span class="header-section-number">6</span> Some more descriptive graphics</h1>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">plot</span>(dd<span class="op">$</span>y, dd<span class="op">$</span>n_frost, <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;No. days with frost in 1st dev. stage&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig08-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">table</span>(dd<span class="op">$</span>n_frost <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span>)</a></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##    63    12</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">plot</span>(dd<span class="op">$</span>y, <span class="dv">0</span> <span class="op">*</span><span class="st"> </span>dd<span class="op">$</span>y, <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)[<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(dd<span class="op">$</span>n_frost <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span>)], <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">16</span>), <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>), </a>
<a class="sourceLine" id="cb54-3" data-line-number="3">       <span class="dt">title =</span> <span class="st">&quot;At least one day with frost [min(T_50cm) &lt; -1.95] in 1st dev. stage:&quot;</span>, </a>
<a class="sourceLine" id="cb54-4" data-line-number="4">       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig09-1.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">plot</span>(dd<span class="op">$</span>year, dd<span class="op">$</span>bud_burst <span class="op">-</span><span class="st"> </span>dd<span class="op">$</span>may1st, <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)[<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(dd<span class="op">$</span>n_frost <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span>)], <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb55-2" data-line-number="2">     <span class="dt">ylab =</span> <span class="st">&quot;Bud burst [Days since May, 1st]&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="kw">text</span>(dd<span class="op">$</span>year, dd<span class="op">$</span>bud_burst <span class="op">-</span><span class="st"> </span>dd<span class="op">$</span>may1st, <span class="dt">labels =</span> dd<span class="op">$</span>end_1st_dev_stage <span class="op">-</span><span class="st"> </span>dd<span class="op">$</span>bud_burst, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="fl">-.5</span>), <span class="dt">cex =</span> <span class="fl">.7</span>)</a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">16</span>), <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>), </a>
<a class="sourceLine" id="cb55-5" data-line-number="5">       <span class="dt">title =</span> <span class="st">&quot;At least one day with frost [min(T_50cm) &lt; -1.95] in 1st dev. stage:&quot;</span>, </a>
<a class="sourceLine" id="cb55-6" data-line-number="6">       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="Frost_data_files/figure-html/fig10-1.png" width="672" /></p>
</div>
<div id="final-data-frame-frost" class="section level1">
<h1><span class="header-section-number">7</span> Final data-frame ‘frost’</h1>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">frost &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">year =</span> dd<span class="op">$</span>year, </a>
<a class="sourceLine" id="cb56-2" data-line-number="2">                    <span class="dt">frost =</span> <span class="kw">as.numeric</span>(dd<span class="op">$</span>n_frost <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb56-3" data-line-number="3"><span class="kw">summary</span>(frost)</a></code></pre></div>
<pre><code>##       year          frost     
##  Min.   :1947   Min.   :0.00  
##  1st Qu.:1966   1st Qu.:0.00  
##  Median :1984   Median :0.00  
##  Mean   :1984   Mean   :0.16  
##  3rd Qu.:2002   3rd Qu.:0.00  
##  Max.   :2021   Max.   :1.00</code></pre>
<!-- # Data availability -->
<!-- ## Data on growth and survival -->
<!-- The repository ([Link](https://erda.ku.dk/archives/845762612be1bf53dd482052126ce220/published-archive.html)) that provides the download link to the data doesn't give any statement on the terms of usage.  -->
<!-- Further, the ["Data availability" section](https://link.springer.com/article/10.1007%2Fs13595-021-01098-5#data-availability) on the Article's website states "Data is publicly available through the University of Copenhagen - Electronic Research Data Archive (ERDA).".  -->
<!-- There is no further information given.  -->
<!-- So it should be okay to use the data for educational purpose, and moreover, the following argumentation for data from Table 1 also applies here. -->
<!-- ## Data fom the article's Table 1 -->
<!-- It is okay to re-use data represented in Table 1 (it should be even more for this solely educational purpose), since recording data is no original work of authorship (following block-quote is from the article ['copyrightability_of_tables_charts_and_graphs.pdf' (University of Michigan)](https://deepblue.lib.umich.edu/bitstream/handle/2027.42/83329/copyrightability_of_tables_charts_and_graphs.pdf), which I found as it was linked to [here](https://copyright.universityofcalifornia.edu/faqs/#d).): -->
<!-- > "Charts, graphs, and tables are not subject to copyright protection because they do not meet the first requirement for copyright protection, that is, they are not “original works of authorship,” under the definitions in the Act (17 U.S.C. § 102(a).). At first glance, this probably doesn't make much sense; if a researcher runs a -->
<!-- series of experiments and collects a data set, isn't that original, and aren't they the author of it? In a -->
<!-- sense, yes, but in the sense that's important for copyright, no. Facts and data aren't considered original -->
<!-- works of authorship because they are not “created” so much as they are “discovered.” For example, if -->
<!-- a scientist takes temperature readings at various locations over a period of years, she isn't “creating” the -->
<!-- data, she's recording the data. If she keeps a log describing how she feels every day, and how the -->
<!-- sunrise looks at the testing station, that's original, creative, authorship. Recording natural phenomena -->
<!-- is not."\ -->
<!-- $\vphantom{.}$  [Unknown author(s), University of Michigan.]{style="float:right"} -->
<!-- # On the form of scaling used here -->
<!-- We center scale and covariates similar to @Dias:Et:Al:2021: -->
<!-- > "In regression modeling it is common practice to empirically  -->
<!--   standardize the covariates by subtracting the empirical mean  -->
<!--   of the observed covariate values and diving the result by  -->
<!--   the empirical standard deviation.  -->
<!--   Here we standardize the covariates based on the available  -->
<!--   domain expertise which improves interpretability and  -->
<!--   generalizability of the resulting inferences as we now show." -->
<!-- @Greenland:Mansournia:2015 write similarly: "..., we strongly advise that quantitative covariates be scaled in units that are contextually meaningful, important, and generalizable (recognizable and transportable)". -->
<!-- # R Code -->
<!-- ```{r, message=FALSE, results='hide', echo=TRUE} -->
<!-- library("plyr") -->
<!-- ## data from article's table 1: -->
<!-- tab_1 <- data.frame(Provenance = c("Diamenar", "Djigueri", "Karofane",  -->
<!--                                    "Sudan", "Kirane", "Kankoussa",  -->
<!--                                    "Chad", "Daiba", "Aite", "Di",  -->
<!--                                    "Bissiga", "Kidira", "Somo",  -->
<!--                                    "Ngane", "Sodera"), -->
<!--                     Rainfall_mm = c(288, 309, 366, 408, 380, 294, 349,  -->
<!--                                     437, 449, 637, 696, 611, 627, 570,  -->
<!--                                     762), -->
<!--                     WAI0_mm = c(28, 45, 51, 56, 59, 60, 64, 65, 75,  -->
<!--                                 121, 128, 184, 187, 194, 292)) -->
<!-- ## data from repository (alternatively using 'encoding = "latin1"'): -->
<!-- df <- read.csv("Growth_A. senegal_AFS.csv", stringsAsFactors = F) -->
<!-- names(df) <- gsub(names(df), pattern = "..", replacement = "_",  -->
<!--                   fixed = T) -->
<!-- names(df) <- gsub(names(df), pattern = ".", replacement = "",  -->
<!--                   fixed = T) -->
<!-- df$Provenance[df$Provenance == "A\xefte"] <- "Aite" ## As in Table 1 -->
<!-- df$Provenance[df$Provenance == "Da\xefba"] <- "Daiba" ## As in Table 1 -->
<!-- head(ddply(df, c("Location", "Block", "Provenance", "Year"), summarise,  -->
<!--       n = length(Survival))) -->
<!-- ## As there is no tree-ID provided, it's not clear of how to access  -->
<!-- ## longitudinal information.  -->
<!-- ## So better only use first measurement: -->
<!-- df <- subset(df, Year == 2008) -->
<!-- ddply(df, c("Location", "Block", "Provenance", "Year"), summarise,  -->
<!--       n = length(Survival)) -->
<!-- df$Loc_Pr <- paste0(df$Location, "_", df$Provenance) -->
<!-- xtabs(~ is.na(Height_m) + Survival, data = df) -->
<!-- xtabs(~ is.na(Diameter_cm) + Survival, data = df) -->
<!-- ## 'Helper variable' line: -->
<!-- df$line <- 1:nrow(df) -->
<!-- (tmp <- subset(df, is.na(Height_m) & (Survival == 1))) -->
<!-- df$Survival[tmp$line] <- 0 -->
<!-- df$Diameter_cm[tmp$line] <- NA -->
<!-- xtabs(~ is.na(Height_m) + Survival, data = df) -->
<!-- xtabs(~ is.na(Diameter_cm) + Survival, data = df) -->
<!-- (tmp <- subset(df, !is.na(Height_m) & (Survival == 0))) -->
<!-- df$Height_m[tmp$line] <- NA -->
<!-- df$Diameter_cm[tmp$line] <- NA -->
<!-- xtabs(~ is.na(Height_m) + Survival, data = df) -->
<!-- xtabs(~ is.na(Diameter_cm) + Survival, data = df) -->
<!-- (tmp <- subset(df, is.na(Diameter_cm) & (Survival == 1))) -->
<!-- df$Survival[tmp$line] <- 0 -->
<!-- df$Height_m[tmp$line] <- NA -->
<!-- xtabs(~ is.na(Height_m) + Survival, data = df) -->
<!-- xtabs(~ is.na(Diameter_cm) + Survival, data = df) -->
<!-- (tmp <- subset(df, !is.na(Diameter_cm) & (Survival == 0))) -->
<!-- df$Height_m[tmp$line] <- NA -->
<!-- df$Diameter_cm[tmp$line] <- NA -->
<!-- xtabs(~ is.na(Height_m) + Survival, data = df) -->
<!-- xtabs(~ is.na(Diameter_cm) + Survival, data = df) -->
<!-- summary(df$Diameter_cm) ## all greater 0 -->
<!-- summary(df$Height_m) ## all greater 0 -->
<!-- df$Height_m[which(is.na(df$Height_m))] <- 0 -->
<!-- df$Diameter_cm[which(is.na(df$Diameter_cm))] <- 0 -->
<!-- df <- merge(df, tab_1, by = "Provenance") -->
<!-- ## Centering and scaling of x -->
<!-- xtabs(~ Block + Loc_Pr, data = df) -->
<!-- summary(df$WAI0_mm) -->
<!-- summary(tab_1$WAI0_mm) -->
<!-- sd(df$WAI0_mm) -->
<!-- sd(tab_1$WAI0_mm) -->
<!-- summary(df$Rainfall_mm) -->
<!-- summary(tab_1$Rainfall_mm) -->
<!-- sd(df$Rainfall_mm) -->
<!-- sd(tab_1$Rainfall_mm) -->
<!-- mean(df$WAI0_mm) -->
<!-- sd(tab_1$WAI0_mm) -->
<!-- df$WAI_c <- (df$WAI0_mm - 100) / 75 -->
<!-- mean(df$Rainfall_mm) -->
<!-- sd(tab_1$Rainfall_mm) -->
<!-- df$Rain_c <- (df$Rainfall_mm - 500) / 150 -->
<!-- ``` -->
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-Hannerz:1994">
<p>Hannerz, Mats. 1994. “Predicting the risk of frost occurrence after budburst of Norway spruce in Sweden.” <em>Silva Fennica</em> 28 (4). <a href="https://silvafennica.fi/article/5535">https://silvafennica.fi/article/5535</a>.</p>
</div>
<div id="ref-Haenninen:1996">
<p>Hänninen, Heikki. 1996. “Effects of Climatic Warming on Northern Trees: Testing the Frost Damage Hypothesis with Meteorological Data from Provenance Transfer Experiments.” <em>Scandinavian Journal of Forest Research</em> 11 (1-4). Taylor; Francis: 17–25. <a href="https://doi.org/10.1080/02827589609382908">https://doi.org/10.1080/02827589609382908</a>.</p>
</div>
<div id="ref-Malmqvist:EtAl:2017">
<p>Malmqvist, Cecilia, Elisabeth Wallin, Anders Lindström, and Harald Säll. 2017. “Differences in Bud Burst Timing and Bud Freezing Tolerance Among Interior and Coastal Seed Sources of Douglas Fir.” <em>Trees</em> 31: 1–12. <a href="https://doi.org/10.1007/s00468-017-1603-x">https://doi.org/10.1007/s00468-017-1603-x</a>.</p>
</div>
<div id="ref-Sagar:Waterhouse:2018">
<p>Sagar, R.M., and M.J. Waterhouse. 2018. “Interaction between Douglas-fir regeneration and frost in central British Columbia.” <em>Prov. B.C., Victoria, B.C. Tech. Rep.</em>, no. 118. <a href="www.for.gov.bc.ca/hfd/pubs/Docs/Tr/Tr118.htm">www.for.gov.bc.ca/hfd/pubs/Docs/Tr/Tr118.htm</a>.</p>
</div>
<div id="ref-Sakai:1987">
<p>Sakai, Akira, and Walter Larcher. 1987. “Freezing Injuries in Plants.” In <em>Frost Survival of Plants: Responses and Adaptation to Freezing Stress</em>, 39–58. Berlin, Heidelberg: Springer Berlin Heidelberg. <a href="https://doi.org/10.1007/978-3-642-71745-1_3">https://doi.org/10.1007/978-3-642-71745-1_3</a>.</p>
</div>
<div id="ref-Thomson:Moncrieff:1982">
<p>Thomson, A. J., and S. M. Moncrieff. 1982. “Prediction of Bud Burst in Douglas-Fir by Degree-Day Accumulation.” <em>Canadian Journal of Forest Research</em> 12 (2): 448–52. <a href="https://doi.org/10.1139/x82-069">https://doi.org/10.1139/x82-069</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Private webpage: <a href="https://uncertaintree.github.io">uncertaintree.github.io</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": false,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsubsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
